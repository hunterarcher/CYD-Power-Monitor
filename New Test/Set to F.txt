F selected
Left - 37f actual and 37f set
Right - 6f actual and 14f set
ECO off
Lock Off
Battery M


*  Executing task: C:\Users\LENOVO\.platformio\penv\Scripts\platformio.exe device monitor 


Please build project in debug configuration to get more details about an exception.
See https://docs.platformio.org/page/projectconf/build_configurations.html


--- Terminal on COM10 | 115200 8-N-1
--- Available filters and text transformations: colorize, debug, default, direct, esp32_exception_decoder, hexlify, log2file, nocontrol, printable, send_on_enter, time
--- More details at https://bit.ly/pio-monitor-filters
--- Quit: Ctrl+C | Menu: Ctrl+T | Help: Ctrl+T followed by Ctrl+H
E (461) quad_psram: PSRAM ID read error: 0xffffffff, PSRAM chip not found or not supported
[    35][E][esp32-hal-psram.c:92] psramAddToHeap(): PSRAM not initialized!



========================================
  FRIDGE PHASE 2.5: KEEP-ALIVE MODE
========================================

⚠️  ACTIVE MODE: Connection + Keep-Alive
   - Will connect to fridge (with retries)
   - Will enable notifications
   - Will send keep-alive every 2 seconds
   - Will NOT send temperature commands

Current Phase: 3 (KEEPALIVE)
Target MAC: ff:ff:11:c6:29:50
Connection retries: 5 max
Keep-alive interval: 2000 ms
Min operation delay: 5000 ms
Reconnect delay: 300 seconds

Initializing BLE...
✓ BLE initialized


[STATE] Ready to scan for fridge
========================================
Starting scan for fridge...
========================================


[STATE] Scanning for fridge...

[SCAN] Looking for fridge (MAC: ff:ff:11:c6:29:50)...
[SCAN] Duration: 10 seconds


🍺 FRIDGE FOUND!
   MAC: ff:ff:11:c6:29:50
   RSSI: -94 dBm
✓ Fridge found!
[DELAY] Waiting 5000 ms - Post-scan stabilization

[STATE] Attempting connection to fridge...

╔════════════════════════════════════════╗
║  PHASE 2.5: CONNECTION + KEEP-ALIVE   ║
╚════════════════════════════════════════╝

⚠️  SAFETY: Keep-alive only
   - Will enable notifications
   - Will send keep-alive every 2 seconds
   - Will NOT send temperature commands
   - Just maintain connection

[Step 1] Creating BLE client...
✓ Client created
[DELAY] Waiting 5000 ms - Post client creation

[Step 2] Connecting to fridge...
   Target: ff:ff:11:c6:29:50
   Will retry up to 5 times

   Attempt 1/5...

✓ BLE Client connected!
   ✓ Connected!

✓ Connected successfully on attempt 1
[DELAY] Waiting 1000 ms - Post connection stabilization (reduced)

[Step 3] Discovering services...

[STATE] Discovering BLE services
✓ Service found
   UUID: 00001234-0000-1000-8000-00805f9b34fb
[DELAY] Waiting 500 ms - Post service discovery (reduced)

[Step 4] Getting characteristics...

[STATE] Getting characteristics

🔍 DIAGNOSTIC: Enumerating ALL characteristics:
[ 15810][E][BLERemoteCharacteristic.cpp:287] retrieveDescriptors(): esp_ble_gattc_get_all_descr: Unknown
[ 15828][E][BLERemoteCharacteristic.cpp:287] retrieveDescriptors(): esp_ble_gattc_get_all_descr: Unknown
   Handle: 0x0006, UUID: 00001235-0000-1000-8000-00805f9b34fb
   Handle: 0x0003, UUID: 00001236-0000-1000-8000-00805f9b34fb
   Handle: 0x0008, UUID: 0000fff1-0000-1000-8000-00805f9b34fb
🔍 END DIAGNOSTIC

✓ Notify characteristic found
   UUID: 00001236-0000-1000-8000-00805f9b34fb
   Handle: 0x0003
✓ Write characteristic found
   UUID: 00001235-0000-1000-8000-00805f9b34fb
   Handle: 0x0006 ⚠️  CHECK IF THIS IS 0x0006!
[DELAY] Waiting 500 ms - Post characteristic discovery (reduced)

[Step 5] Enabling notifications...

[STATE] Enabling notifications
⚠️  IMPORTANT: Enabling notifications ONLY
   - Using manual CCCD write (like nRF Connect)
   - Not sending any data
   - Not sending keep-alive
   - Just listening

[5a] Registering callback function...
✓ Callback registered (notifications not enabled yet)
[DELAY] Waiting 500 ms - Post callback registration (reduced)

[5b] Manually enabling notifications via CCCD write...
   Finding CCCD descriptor (0x2902)...
✓ CCCD descriptor found
[DELAY] Waiting 500 ms - Pre-CCCD write (reduced)
   Writing 0x01 0x00 to CCCD...
✓ CCCD write complete - Notifications enabled!
[DELAY] Waiting 1000 ms - Post notification enable (reduced)

[Step 6] Starting keep-alive loop...
⚠️  CRITICAL: Keep-alive is REQUIRED
   - Sending FE FE 03 01 02 00 every 2 seconds
   - Fridge will disconnect without it
   - This prevents GATT CONN TIMEOUT

[DELAY] Waiting 1000 ms - Before first keep-alive (reduced)
   Sending FIRST keep-alive...
   Data: FE FE 03 01 02 00
   ✓ First keep-alive sent!


========================================
📨 NOTIFICATION #1 RECEIVED!
========================================
Length: 20 bytes
Data: FE FE 21 01 00 01 00 01 25 44 FC 04 00 01 FB FB
      FB 00 25 64 

✓ Valid frame detected (FE FE 21)
  Type: Status frame (DECODED)

  📊 DECODED STATUS:
     🔹 Zone: 0x01 (LEFT compartment)
     🔹 ECO Mode: 0x00 (ON)
     🔹 Battery Protection: 0x01 (M = 10.1V - assumed)
     🔹 Setpoint: 37°C (LEFT)

     📍 Monitoring for ACTUAL temperature:
     Byte 9:  0x44 (dec: 68, signed: 68)
     Byte 10: 0xFC (dec: 252, signed: -4)
     Byte 11: 0x04 (dec: 4, signed: 4)

     Status flags: 0x00 0x01
     Sequence: 0x25
     ✓ Values stored
========================================


========================================
📨 NOTIFICATION #2 RECEIVED!
========================================
Length: 16 bytes
Data: 0D 05 0E 00 00 04 FB FB FB 00 06 00 00 00 0A 1F 


  Type: Actual Temperature Frame (DECODED)

  🌡️  ACTUAL TEMPERATURES:
     🔹 LEFT Actual: 5°C
     🔹 RIGHT Setpoint: 14°C
     🔹 RIGHT Actual: 6°C

     Sequence: 0x0D
     ✓ Values stored
========================================


[Step 7] Connection complete!

[STATE] Connected - Keep-alive active

╔════════════════════════════════════════╗
║  CONNECTION SUCCESSFUL!                ║
╚════════════════════════════════════════╝

Connection time: 12610 ms
Connection attempts: 1
Connection retries: 0

📝 NOW RUNNING:
   - Keep-alive every 2 seconds (automatic)
   - Monitoring notifications from fridge
   - Connection should stay stable
   - Watch for responses to keep-alive

[Keep-Alive #2] Sending... ✓ Sent

========================================
📨 NOTIFICATION #3 RECEIVED!
========================================
Length: 20 bytes
Data: FE FE 21 01 00 01 00 01 25 44 FC 04 00 01 FB FB
      FB 00 25 64 

✓ Valid frame detected (FE FE 21)
  Type: Status frame (DECODED)

  📊 DECODED STATUS:
     🔹 Zone: 0x01 (LEFT compartment)
     🔹 ECO Mode: 0x00 (ON)
     🔹 Battery Protection: 0x01 (M = 10.1V - assumed)
     🔹 Setpoint: 37°C (LEFT)

     📍 Monitoring for ACTUAL temperature:
     Byte 9:  0x44 (dec: 68, signed: 68)
     Byte 10: 0xFC (dec: 252, signed: -4)
     Byte 11: 0x04 (dec: 4, signed: 4)

     Status flags: 0x00 0x01
     Sequence: 0x25
     ✓ Values stored
========================================


========================================
📨 NOTIFICATION #4 RECEIVED!
========================================
Length: 16 bytes
Data: 0D 05 0E 00 00 04 FB FB FB 00 06 00 00 00 0A 1F 


  Type: Actual Temperature Frame (DECODED)

  🌡️  ACTUAL TEMPERATURES:
     🔹 LEFT Actual: 5°C
     🔹 RIGHT Setpoint: 14°C
     🔹 RIGHT Actual: 6°C

     Sequence: 0x0D
     ✓ Values stored
========================================

[Keep-Alive #3] Sending... ✓ Sent

========================================
📨 NOTIFICATION #5 RECEIVED!
========================================
Length: 20 bytes
Data: FE FE 21 01 00 01 00 01 25 44 FC 04 00 01 FB FB
      FB 00 25 64

✓ Valid frame detected (FE FE 21)
  Type: Status frame (DECODED)

  📊 DECODED STATUS:
     🔹 Zone: 0x01 (LEFT compartment)
     🔹 ECO Mode: 0x00 (ON)
     🔹 Battery Protection: 0x01 (M = 10.1V - assumed)
     🔹 Setpoint: 37°C (LEFT)

     📍 Monitoring for ACTUAL temperature:
     Byte 9:  0x44 (dec: 68, signed: 68)
     Byte 10: 0xFC (dec: 252, signed: -4)
     Byte 11: 0x04 (dec: 4, signed: 4)

     Status flags: 0x00 0x01
     Sequence: 0x25
     ✓ Values stored
========================================


========================================
📨 NOTIFICATION #6 RECEIVED!
========================================
Length: 16 bytes
Data: 0D 05 0E 00 00 04 FB FB FB 00 06 00 00 00 0A 1F 


  Type: Actual Temperature Frame (DECODED)

  🌡️  ACTUAL TEMPERATURES:
     🔹 LEFT Actual: 5°C
     🔹 RIGHT Setpoint: 14°C
     🔹 RIGHT Actual: 6°C

     Sequence: 0x0D
     ✓ Values stored
========================================

[Keep-Alive #4] Sending... ✓ Sent

========================================
📨 NOTIFICATION #7 RECEIVED!
========================================
Length: 20 bytes
Data: FE FE 21 01 00 01 00 01 25 44 FC 04 00 01 FB FB
      FB 00 25 64 

✓ Valid frame detected (FE FE 21)
  Type: Status frame (DECODED)

  📊 DECODED STATUS:
     🔹 Zone: 0x01 (LEFT compartment)
     🔹 ECO Mode: 0x00 (ON)
     🔹 Battery Protection: 0x01 (M = 10.1V - assumed)
     🔹 Setpoint: 37°C (LEFT)

     📍 Monitoring for ACTUAL temperature:
     Byte 9:  0x44 (dec: 68, signed: 68)
     Byte 10: 0xFC (dec: 252, signed: -4)
     Byte 11: 0x04 (dec: 4, signed: 4)

     Status flags: 0x00 0x01
     Sequence: 0x25
     ✓ Values stored
========================================


========================================
📨 NOTIFICATION #8 RECEIVED!
========================================
Length: 16 bytes
Data: 0D 05 0E 00 00 04 FB FB FB 00 06 00 00 00 0A 1F 


  Type: Actual Temperature Frame (DECODED)

  🌡️  ACTUAL TEMPERATURES:
     🔹 LEFT Actual: 5°C
     🔹 RIGHT Setpoint: 14°C
     🔹 RIGHT Actual: 6°C

     Sequence: 0x0D
     ✓ Values stored
========================================

[Keep-Alive #5] Sending... ✓ Sent

========================================
📨 NOTIFICATION #9 RECEIVED!
========================================
Length: 20 bytes
Data: FE FE 21 01 00 01 00 01 25 44 FC 04 00 01 FB FB 
      FB 00 25 64

✓ Valid frame detected (FE FE 21)
  Type: Status frame (DECODED)

  📊 DECODED STATUS:
     🔹 Zone: 0x01 (LEFT compartment)
     🔹 ECO Mode: 0x00 (ON)
     🔹 Battery Protection: 0x01 (M = 10.1V - assumed)
     🔹 Setpoint: 37°C (LEFT)

     📍 Monitoring for ACTUAL temperature:
     Byte 9:  0x44 (dec: 68, signed: 68)
     Byte 10: 0xFC (dec: 252, signed: -4)
     Byte 11: 0x04 (dec: 4, signed: 4)

     Status flags: 0x00 0x01
     Sequence: 0x25
     ✓ Values stored
========================================


========================================
📨 NOTIFICATION #10 RECEIVED!
========================================
Length: 16 bytes
Data: 0D 05 0E 00 00 04 FB FB FB 00 06 00 00 00 0A 1F 


  Type: Actual Temperature Frame (DECODED)

  🌡️  ACTUAL TEMPERATURES:
     🔹 LEFT Actual: 5°C
     🔹 RIGHT Setpoint: 14°C
     🔹 RIGHT Actual: 6°C

     Sequence: 0x0D
     ✓ Values stored
========================================

[Keep-Alive #6] Sending... ✓ Sent

========================================
📨 NOTIFICATION #11 RECEIVED!
========================================
Length: 20 bytes
Data: FE FE 21 01 00 01 00 01 25 44 FC 04 00 01 FB FB
      FB 00 25 64 

✓ Valid frame detected (FE FE 21)
  Type: Status frame (DECODED)

  📊 DECODED STATUS:
     🔹 Zone: 0x01 (LEFT compartment)
     🔹 ECO Mode: 0x00 (ON)
     🔹 Battery Protection: 0x01 (M = 10.1V - assumed)
     🔹 Setpoint: 37°C (LEFT)

     📍 Monitoring for ACTUAL temperature:
     Byte 9:  0x44 (dec: 68, signed: 68)
     Byte 10: 0xFC (dec: 252, signed: -4)
     Byte 11: 0x04 (dec: 4, signed: 4)

     Status flags: 0x00 0x01
     Sequence: 0x25
     ✓ Values stored
========================================


========================================
📨 NOTIFICATION #12 RECEIVED!
========================================
Length: 16 bytes
Data: 0D 05 0E 00 00 04 FB FB FB 00 06 00 00 00 0A 1F 


  Type: Actual Temperature Frame (DECODED)

  🌡️  ACTUAL TEMPERATURES:
     🔹 LEFT Actual: 5°C
     🔹 RIGHT Setpoint: 14°C
     🔹 RIGHT Actual: 6°C

     Sequence: 0x0D
     ✓ Values stored
========================================

[Keep-Alive #7] Sending... ✓ Sent

========================================
📨 NOTIFICATION #13 RECEIVED!
========================================
Length: 20 bytes
Data: FE FE 21 01 00 01 00 01 25 44 FC 04 00 01 FB FB
      FB 00 25 64 

✓ Valid frame detected (FE FE 21)
  Type: Status frame (DECODED)

  📊 DECODED STATUS:
     🔹 Zone: 0x01 (LEFT compartment)
     🔹 ECO Mode: 0x00 (ON)
     🔹 Battery Protection: 0x01 (M = 10.1V - assumed)
     🔹 Setpoint: 37°C (LEFT)

     📍 Monitoring for ACTUAL temperature:
     Byte 9:  0x44 (dec: 68, signed: 68)
     Byte 10: 0xFC (dec: 252, signed: -4)
     Byte 11: 0x04 (dec: 4, signed: 4)

     Status flags: 0x00 0x01
     Sequence: 0x25
     ✓ Values stored
========================================


========================================
📨 NOTIFICATION #14 RECEIVED!
========================================
Length: 16 bytes
Data: 0D 05 0E 00 00 04 FB FB FB 00 06 00 00 00 0A 1F 


  Type: Actual Temperature Frame (DECODED)

  🌡️  ACTUAL TEMPERATURES:
     🔹 LEFT Actual: 5°C
     🔹 RIGHT Setpoint: 14°C
     🔹 RIGHT Actual: 6°C

     Sequence: 0x0D
     ✓ Values stored
========================================

[Keep-Alive #8] Sending... ✓ Sent

========================================
📨 NOTIFICATION #15 RECEIVED!
========================================
Length: 20 bytes
Data: FE FE 21 01 00 01 00 01 25 44 FC 04 00 01 FB FB
      FB 00 25 64 

✓ Valid frame detected (FE FE 21)
  Type: Status frame (DECODED)

  📊 DECODED STATUS:
     🔹 Zone: 0x01 (LEFT compartment)
     🔹 ECO Mode: 0x00 (ON)
     🔹 Battery Protection: 0x01 (M = 10.1V - assumed)
     🔹 Setpoint: 37°C (LEFT)

     📍 Monitoring for ACTUAL temperature:
     Byte 9:  0x44 (dec: 68, signed: 68)
     Byte 10: 0xFC (dec: 252, signed: -4)
     Byte 11: 0x04 (dec: 4, signed: 4)

     Status flags: 0x00 0x01
     Sequence: 0x25
     ✓ Values stored
========================================


========================================
📨 NOTIFICATION #16 RECEIVED!
========================================
Length: 16 bytes
Data: 0D 05 0E 00 00 04 FB FB FB 00 06 00 00 00 0A 1F 


  Type: Actual Temperature Frame (DECODED)

  🌡️  ACTUAL TEMPERATURES:
     🔹 LEFT Actual: 5°C
     🔹 RIGHT Setpoint: 14°C
     🔹 RIGHT Actual: 6°C

     Sequence: 0x0D
     ✓ Values stored
========================================

[Keep-Alive #9] Sending... ✓ Sent

========================================
📨 NOTIFICATION #17 RECEIVED!
========================================
Length: 20 bytes
Data: FE FE 21 01 00 01 00 01 25 44 FC 04 00 01 FB FB
      FB 00 25 64 

✓ Valid frame detected (FE FE 21)
  Type: Status frame (DECODED)

  📊 DECODED STATUS:
     🔹 Zone: 0x01 (LEFT compartment)
     🔹 ECO Mode: 0x00 (ON)
     🔹 Battery Protection: 0x01 (M = 10.1V - assumed)
     🔹 Setpoint: 37°C (LEFT)

     📍 Monitoring for ACTUAL temperature:
     Byte 9:  0x44 (dec: 68, signed: 68)
     Byte 10: 0xFC (dec: 252, signed: -4)
     Byte 11: 0x04 (dec: 4, signed: 4)

     Status flags: 0x00 0x01
     Sequence: 0x25
     ✓ Values stored
========================================


========================================
📨 NOTIFICATION #18 RECEIVED!
========================================
Length: 16 bytes
Data: 0D 05 0E 00 00 04 FB FB FB 00 06 00 00 00 0A 1F 


  Type: Actual Temperature Frame (DECODED)

  🌡️  ACTUAL TEMPERATURES:
     🔹 LEFT Actual: 5°C
     🔹 RIGHT Setpoint: 14°C
     🔹 RIGHT Actual: 6°C

     Sequence: 0x0D
     ✓ Values stored
========================================

[Keep-Alive #10] Sending... ✓ Sent

========================================
📨 NOTIFICATION #19 RECEIVED!
========================================
Length: 20 bytes
Data: FE FE 21 01 00 01 00 01 25 44 FC 04 00 01 FB FB
      FB 00 25 64 

✓ Valid frame detected (FE FE 21)
  Type: Status frame (DECODED)

  📊 DECODED STATUS:
     🔹 Zone: 0x01 (LEFT compartment)
     🔹 ECO Mode: 0x00 (ON)
     🔹 Battery Protection: 0x01 (M = 10.1V - assumed)
     🔹 Setpoint: 37°C (LEFT)

     📍 Monitoring for ACTUAL temperature:
     Byte 9:  0x44 (dec: 68, signed: 68)
     Byte 10: 0xFC (dec: 252, signed: -4)
     Byte 11: 0x04 (dec: 4, signed: 4)

     Status flags: 0x00 0x01
     Sequence: 0x25
     ✓ Values stored
========================================


========================================
📨 NOTIFICATION #20 RECEIVED!
========================================
Length: 16 bytes
Data: 0D 05 0E 00 00 04 FB FB FB 00 06 00 00 00 0A 1F 


  Type: Actual Temperature Frame (DECODED)

  🌡️  ACTUAL TEMPERATURES:
     🔹 LEFT Actual: 5°C
     🔹 RIGHT Setpoint: 14°C
     🔹 RIGHT Actual: 6°C

     Sequence: 0x0D
     ✓ Values stored
========================================

[Keep-Alive #11] Sending... ✓ Sent

========================================
📨 NOTIFICATION #21 RECEIVED!
========================================
Length: 20 bytes
Data: FE FE 21 01 00 01 00 01 25 44 FC 04 00 01 FB FB
      FB 00 25 64 

✓ Valid frame detected (FE FE 21)
  Type: Status frame (DECODED)

  📊 DECODED STATUS:
     🔹 Zone: 0x01 (LEFT compartment)
     🔹 ECO Mode: 0x00 (ON)
     🔹 Battery Protection: 0x01 (M = 10.1V - assumed)
     🔹 Setpoint: 37°C (LEFT)

     📍 Monitoring for ACTUAL temperature:
     Byte 9:  0x44 (dec: 68, signed: 68)
     Byte 10: 0xFC (dec: 252, signed: -4)
     Byte 11: 0x04 (dec: 4, signed: 4)

     Status flags: 0x00 0x01
     Sequence: 0x25
     ✓ Values stored
========================================


========================================
📨 NOTIFICATION #22 RECEIVED!
========================================
Length: 16 bytes
Data: 0D 05 0E 00 00 04 FB FB FB 00 07 00 00 00 0A 20 


  Type: Actual Temperature Frame (DECODED)

  🌡️  ACTUAL TEMPERATURES:
     🔹 LEFT Actual: 5°C
     🔹 RIGHT Setpoint: 14°C
     🔹 RIGHT Actual: 7°C

     Sequence: 0x0D
     ✓ Values stored
========================================

[Keep-Alive #12] Sending... ✓ Sent

========================================
📨 NOTIFICATION #23 RECEIVED!
========================================
Length: 20 bytes
Data: FE FE 21 01 00 01 00 01 25 44 FC 04 00 01 FB FB
      FB 00 25 64 

✓ Valid frame detected (FE FE 21)
  Type: Status frame (DECODED)

  📊 DECODED STATUS:
     🔹 Zone: 0x01 (LEFT compartment)
     🔹 ECO Mode: 0x00 (ON)
     🔹 Battery Protection: 0x01 (M = 10.1V - assumed)
     🔹 Setpoint: 37°C (LEFT)

     📍 Monitoring for ACTUAL temperature:
     Byte 9:  0x44 (dec: 68, signed: 68)
     Byte 10: 0xFC (dec: 252, signed: -4)
     Byte 11: 0x04 (dec: 4, signed: 4)

     Status flags: 0x00 0x01
     Sequence: 0x25
     ✓ Values stored
========================================


========================================
📨 NOTIFICATION #24 RECEIVED!
========================================
Length: 16 bytes
Data: 0D 05 0E 00 00 04 FB FB FB 00 07 00 00 00 0A 20 


  Type: Actual Temperature Frame (DECODED)

  🌡️  ACTUAL TEMPERATURES:
     🔹 LEFT Actual: 5°C
     🔹 RIGHT Setpoint: 14°C
     🔹 RIGHT Actual: 7°C

     Sequence: 0x0D
     ✓ Values stored
========================================

[Keep-Alive #13] Sending... ✓ Sent

========================================
📨 NOTIFICATION #25 RECEIVED!
========================================
Length: 20 bytes
Data: FE FE 21 01 00 01 00 01 25 44 FC 04 00 01 FB FB
      FB 00 25 64

✓ Valid frame detected (FE FE 21)
  Type: Status frame (DECODED)

  📊 DECODED STATUS:
     🔹 Zone: 0x01 (LEFT compartment)
     🔹 ECO Mode: 0x00 (ON)
     🔹 Battery Protection: 0x01 (M = 10.1V - assumed)
     🔹 Setpoint: 37°C (LEFT)

     📍 Monitoring for ACTUAL temperature:
     Byte 9:  0x44 (dec: 68, signed: 68)
     Byte 10: 0xFC (dec: 252, signed: -4)
     Byte 11: 0x04 (dec: 4, signed: 4)

     Status flags: 0x00 0x01
     Sequence: 0x25
     ✓ Values stored
========================================


========================================
📨 NOTIFICATION #26 RECEIVED!
========================================
Length: 16 bytes
Data: 0D 05 0E 00 00 04 FB FB FB 00 07 00 00 00 0A 20 


  Type: Actual Temperature Frame (DECODED)

  🌡️  ACTUAL TEMPERATURES:
     🔹 LEFT Actual: 5°C
     🔹 RIGHT Setpoint: 14°C
     🔹 RIGHT Actual: 7°C

     Sequence: 0x0D
     ✓ Values stored
========================================